{{ define "title" }}
    {{ partial "header.html" (dict "content" . "while" 1) }}
{{ end }}

{{ define "main" }}
<section class="cover-post">
    {{if .Params.image}}
        <div class="cover-background" style="background-image: url('{{ "image/" | absURL }}{{ .Params.image }}');"></div>
    {{else}}
        <div class="cover-background" style="background-image: url('https://unsplash.it/1920/800?random');"></div>
    {{end}}
    <div class="cover-gradient"></div>
    <div class="container cover-contents">
        <div class="post-categories">
            {{ range $index, $category := .Params.categories }}
                <a class="post-category" href="{{ $.Site.BaseURL }}categories/{{ $category | urlize }}/">{{ . }}</a>
            {{ end }}
        </div>
        <h1 class="post-title">{{ .Title }}</h1>
        {{if .Params.excerpt }}
            <hr>
            <p class="post-subtitle">{{ .Params.excerpt }}</p>
        {{ end }}
    </div>
</section>
<!--  -->
<!--  -->
<section class="post-meta-bar">
    <div class="post-meta-contents">
        <div class="post-meta-author">
            {{if .Params.translate }}
                <a href="{{.Params.translate.url}}" target="_blank" class="post-meta-author-avatar">
                    <img alt="{{.Params.translate.name}}" src="{{ "image/" | absURL }}{{ .Params.translate.avatar }}"> </a>
                <div class="post-meta-author-info">
                    <span>Оригинал</span>
                    <a href="{{.Params.translate.url}}" target="_blank">{{.Params.translate.name}}</a>
                </div>
            {{else}}
                <a href="{{ "" | absLangURL }}" class="post-meta-author-avatar">
                    <img alt="" src="{{ "assets/avatar.jpg" | relLangURL }}"> </a>
                <div class="post-meta-author-info">
                    <span>Автор</span>
                    <a href="{{ "" | absLangURL }}">{{ .Site.Author.name }}</a>
                </div>
            {{end}}
        </div>
        <div class="post-meta-date">
            {{if .Params.Date}}
                <time class="Unix-time" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" | safeHTML }}">{{ .Date.Unix | safeHTML }}</time>
            {{end}}
        </div>
    </div>
</section>
<!--  -->
<!--  -->
<section class="container post">
    {{ .Content }}
    <!-- Tag -->
    <div class="post-tags">
        {{ range $index, $tags := .Params.tags }}
            <a href="{{ $.Site.BaseURL }}tags/{{ $tags | urlize }}/" rel="tag">{{ . }}</a>
        {{ end }}
    </div>
    <!-- End tag -->
</section>
<!--  -->
<!--  -->

<!-- Embeded svg sprite reference -->
<svg display="none" xmlns="http://www.w3.org/2000/svg">
    <symbol id="post-share-svg_vk" viewBox="0 0 24 28" >
        <path d="M30 8.1c0.2 0.6-0.5 2.1-2.3 4.6-3 4-3.4 3.7-0.9 6 2.4 2.2 2.9 3.3 3 3.5 0 0 1 1.8-1.1 1.8l-4 0.1c-0.9 0.2-2-0.6-2-0.6-1.5-1-2.9-3.7-4-3.4 0 0-1.1 0.4-1.1 2.8 0 0.5-0.2 0.8-0.2 0.8s-0.3 0.3-0.8 0.3h-1.8c-4 0.3-7.4-3.4-7.4-3.4s-3.8-3.9-7.2-11.8c-0.2-0.5 0-0.8 0-0.8s0.2-0.3 0.9-0.3l4.3 0c0.4 0.1 0.7 0.3 0.7 0.3s0.3 0.2 0.4 0.5c0.7 1.8 1.6 3.3 1.6 3.3 1.6 3.2 2.6 3.8 3.2 3.4 0 0 0.8-0.5 0.6-4.4-0.1-1.4-0.5-2-0.5-2-0.4-0.5-1-0.6-1.3-0.7-0.2 0 0.2-0.6 0.7-0.8 0.8-0.4 2.1-0.4 3.7-0.4 1.3 0 1.6 0.1 2.1 0.2 1.5 0.4 1 1.7 1 5 0 1.1-0.2 2.5 0.6 3 0.3 0.2 1.1 0 3.1-3.4 0 0 0.9-1.6 1.7-3.5 0.1-0.3 0.4-0.5 0.4-0.5s0.3-0.1 0.6-0.1l4.5 0c1.4-0.2 1.6 0.5 1.6 0.5z"/>
    </symbol> 
   <symbol id="post-share-svg_twitter" viewBox="0 0 24 28" >
        <path d="M25.3 6.4c-0.7 1-1.5 1.9-2.5 2.6 0 0.2 0 0.4 0 0.7 0 6.7-5.1 14.4-14.4 14.4-2.9 0-5.5-0.8-7.7-2.3 0.4 0 0.8 0.1 1.2 0.1 2.4 0 4.5-0.8 6.3-2.2-2.2 0-4.1-1.5-4.7-3.5 0.3 0 0.6 0.1 1 0.1 0.5 0 0.9-0.1 1.3-0.2-2.3-0.5-4-2.5-4-5v-0.1c0.7 0.4 1.5 0.6 2.3 0.6-1.4-0.9-2.2-2.5-2.2-4.2 0-0.9 0.3-1.8 0.7-2.5 2.5 3.1 6.2 5.1 10.4 5.3-0.1-0.4-0.1-0.8-0.1-1.2 0-2.8 2.3-5 5-5 1.5 0 2.8 0.6 3.7 1.6 1.1-0.2 2.2-0.6 3.2-1.2-0.4 1.2-1.2 2.2-2.2 2.8 1-0.1 2-0.4 2.9-0.8z"/>
    </symbol>
    <symbol id="post-share-svg_telegram" viewBox="0 0 448 512" >
        <path d="M446.7 98.6l-67.6 318.8c-5.1 22.5-18.4 28.1-37.3 17.5l-103-75.9-49.7 47.8c-5.5 5.5-10.1 10.1-20.7 10.1l7.4-104.9 190.9-172.5c8.3-7.4-1.8-11.5-12.9-4.1L117.8 284 16.2 252.2c-22.1-6.9-22.5-22.1 4.6-32.7L418.2 66.4c18.4-6.9 34.5 4.1 28.5 32.2z"/>
    </symbol>
    <symbol id="post-share-svg_google" viewBox="0 0 24 28" >
        <path d="M12 12.3h11.3c0.1 0.6 0.2 1.2 0.2 2 0 6.8-4.6 11.7-11.5 11.7-6.6 0-12-5.4-12-12s5.4-12 12-12c3.2 0 6 1.2 8 3.1l-3.3 3.1c-0.9-0.9-2.5-1.9-4.8-1.9-4.1 0-7.4 3.4-7.4 7.6s3.3 7.6 7.4 7.6c4.8 0 6.5-3.4 6.8-5.2h-6.8v-4.1z"/>
    </symbol>
</svg>

<section class="post-footer">
    <div class="container post-footer-wrapper">
        <ul class="post-share">
            <li class="post-share-title">Поделиться:</li>

            <li class="post-share-twitter"
                onClick="openPopup('http://twitter.com/share?text={{ .Title }}&url={{ .Permalink }}', 548, 300)">
                <a>
                    <svg>
                        <use xlink:href="#post-share-svg_twitter" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
                    </svg>
                    Twitter
                </a>
            </li>

            <li class="post-share-vk"
                {{if .Params.excerpt }}
                    onClick="openPopup('https://vk.com/share.php?url={{ .Permalink }}&description={{ .Params.excerpt }}', 650, 570)">                
                {{else}}
                    onClick="openPopup('https://vk.com/share.php?url={{ .Permalink }}', 650, 570)">                
                {{end}}
                <a>
                    <svg>
                        <use xlink:href="#post-share-svg_vk" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
                    </svg>
                    Vkontakte
                </a>
            </li>

            <li class="post-share-telegram"
                onClick="openPopup('https://telegram.me/share/url?url={{ .Permalink }}&text={{ .Title }}', 650, 570)">       
                <a>
                    <svg>
                        <use xlink:href="#post-share-svg_telegram" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
                    </svg>
                    Telegram
                </a>
            </li>
        </ul>
<!--         
        <div class="post-nav-wrapper">
            <a href="#" class="post-nav post-nav-next">
                <span>Предыдущая запись</span>
                <h4 class="post-title">2038: остался всего 21 год</h4>
            </a>
            <a href="#" class="post-nav post-nav-previous">
                <span>Следующая заипсь</span>
                <h4 class="post-title">Системы инициализации Unix и Linux после SysV</h4>
            </a>
        </div> -->
    </div>
</section>
<!--  -->
<!--  -->
<div class="container">
    <div id="disqus_thread">

        <div id="disqus_loader">
            <!-- By Sam Herbert (@sherb), for everyone. More @ http://goo.gl/7AJzbL -->
            <svg viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#55acee">
                <g fill="none" fill-rule="evenodd">
                    <g transform="translate(1 1)" stroke-width="2">
                        <circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
                        <path d="M36 18c0-9.94-8.06-18-18-18">
                            <animateTransform
                                attributeName="transform"
                                type="rotate"
                                from="0 18 18"
                                to="360 18 18"
                                dur="1s"
                                repeatCount="indefinite"/>
                        </path>
                    </g>
                </g>
            </svg>
        </div>

    </div>
</div>

<script type="text/javascript">
    "use strict";

    function openPopup(url, width, height) {
        var left = (window.screen.width - width) / 2
        var top = (window.screen.height - height) / 2
        var w = window.open( url, '', 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top);
        w.focus()
    }

    function isInViewport(elem) {
        var bounding = elem.getBoundingClientRect();
        return (
            bounding.top <= (window.innerHeight || document.documentElement.clientHeight) &&
            bounding.left <= (window.innerWidth || document.documentElement.clientWidth)
        );
    };

    var loader = document.querySelector("#disqus_loader");

    var disqus_config = function () {
        this.page.url = '{{ .Permalink }}';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '{{ .UniqueID }}'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    function handler(params) {
        if(!isInViewport(loader)) return
        removeEventListener('DOMContentLoaded', handler, false); 
        removeEventListener('load', handler, false); 
        removeEventListener('scroll', handler, false); 
        removeEventListener('resize', handler, false); 

        var d = document, s = d.createElement('script');
        s.src = 'https://grishyru.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    }

    addEventListener('DOMContentLoaded', handler, false); 
    addEventListener('load', handler, false); 
    addEventListener('scroll', handler, false); 
    addEventListener('resize', handler, false); 
</script>

{{ end }}
